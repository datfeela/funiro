"use strict";const isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};document.addEventListener("DOMContentLoaded",(e=>{(new Date).getTime();document.addEventListener("click",(e=>{e.target.closest("a")&&e.preventDefault();//!контрю переход по ссылке, убрать позже
}));const t=document.querySelector(".header__menu");t.addEventListener("click",(function(e){const s=e.target;if(document.documentElement.clientWidth>768)if(!s.closest(".menu__sub-list")&&s.closest(".menu__item._hover"))s.closest(".menu__item").classList.toggle("_hover");else if(s.closest(".menu__item")){let e=t.querySelector(".menu__item._hover");e&&e.classList.remove("_hover"),s.closest(".menu__item").classList.toggle("_hover")}})),document.addEventListener("click",(e=>{const t=e.target,s=document.querySelector("._hover");t.closest(".menu__item")||null==s||s.classList.remove("_hover")})),$(".menu__arrow").click((function(){document.documentElement.clientWidth<=768&&($(this).next(".menu__sub-list").slideToggle(),$(this).toggleClass("_active"))})),$(window).resize((function(){document.documentElement.clientWidth>768&&($(".menu__sub-list").css("display","block"),$(".menu__arrow").hasClass("_active")&&$(".menu__arrow").removeClass("_active")),document.documentElement.clientWidth<768&&($(".menu__arrow").hasClass("_active")||$(".menu__sub-list").css("display","none"))}));const s=document.querySelector(".search-form");s.addEventListener("click",(e=>{e.target.closest(".search-form__button_lowres")&&s.classList.toggle("_active")})),document.addEventListener("click",(e=>{const t=e.target,s=document.querySelector(".search-form");!t.closest(".search-form")&&s.classList.contains("_active")&&s.classList.remove("_active")}));document.querySelector(".burger").addEventListener("click",(e=>{t.classList.toggle("_active")}));const i=document.querySelector(".header");new IntersectionObserver((function(e,t){e[0].isIntersecting?i.classList.remove("_scroll"):i.classList.add("_scroll")})).observe(i);class o{constructor(e){this.sliderWrap=e.sliderWrap,this.nextBtn=e.nextBtn,this.prevBtn=e.prevBtn,this.sliderPos=e.sliderPos,this.isDragging=!1,this.startPos,this.slidesPerSwipe=e.slidesPerSwipe,this.currentTranslate,this.prevTranslate=0,this.startTime,this.endTime,this.activeDot=e.activeDot,this.sliderPages=e.sliderPages,this.activePage,this.dots=e.dots,this.sliderName=e.sliderName}touchStart(e){this.startPos=this.getPositionX(e),this.isDragging=!0,this.startTime=(new Date).getTime()}touchMove(e){if(this.isDragging){const t=this.getPositionX(e);this.currentTranslate=this.prevTranslate+t-this.startPos}}touchEnd(){this.isDragging=!1;const e=this.currentTranslate-this.prevTranslate;this.endTime=(new Date).getTime()-this.startTime,e<-150&&this.endTime<400&&this.swipeRight(),e>150&&this.endTime<400&&this.swipeLeft()}getPositionX(e){return e.type.includes("mouse")?e.pageX:e.touches[0].clientX}swipeRight(){this.sliderPos<Math.ceil(this.sliderWrap.childElementCount/this.slidesPerSwipe)-1&&(this.sliderPos+=1,this.swipeSlider(),this.changeActiveSlide())}swipeLeft(){this.sliderPos>0&&(this.sliderPos-=1,this.swipeSlider(),this.changeActiveSlide())}swipeOnDot(e){if(e.target.classList.contains(`controls-${this.sliderName}__dot`)&&!e.target.classList.contains("_active")){this.activeDot.classList.remove("_active"),e.target.classList.add("_active");let t=this.dots.firstElementChild.id.length-1;this.activeDot=e.target,this.sliderPos=e.target.id.slice(t)-1,this.sliderWrap.style.transform=`translateX(${this.sliderPos*-this.calcSlideWidth()*this.slidesPerSwipe}px)`,this.changeActiveSlide(),this.blockButtons()}}calcSlideWidth(){let e=getComputedStyle(this.activePage).width;e=e.slice(0,3);let t=getComputedStyle(this.activePage).marginRight;return t=t.slice(0,2),e=+e+ +t,e}swipeSlider(){this.sliderWrap.style.transform=`translateX(${this.sliderPos*-this.calcSlideWidth()*this.slidesPerSwipe}px)`,this.activeDot.classList.remove("_active"),this.activeDot=document.querySelector(`.controls-${this.sliderName}__dot_${this.sliderPos+1}`),this.activeDot.classList.add("_active"),this.blockButtons()}changeActiveSlide(){this.activePage.classList.remove("_active"),this.activePage=document.getElementById(`${this.sliderName}-page-${this.sliderPos*this.slidesPerSwipe+1}`),this.activePage.classList.add("_active")}blockButtons(){switch(this.sliderPos){case 0:this.prevBtn.classList.contains("_blocked")||this.prevBtn.classList.add("_blocked"),this.nextBtn.classList.contains("_blocked")&&this.nextBtn.classList.remove("_blocked");break;case Math.ceil(this.sliderWrap.childElementCount/this.slidesPerSwipe)-1:this.nextBtn.classList.contains("_blocked")||this.nextBtn.classList.add("_blocked"),this.prevBtn.classList.contains("_blocked")&&this.prevBtn.classList.remove("_blocked");break;default:this.nextBtn.classList.contains("_blocked")&&this.nextBtn.classList.remove("_blocked"),this.prevBtn.classList.contains("_blocked")&&this.prevBtn.classList.remove("_blocked")}}hideDots(){let e=Array.from(this.dots.children),t=Math.ceil(e.length/this.slidesPerSwipe);for(let s=t;s<e.length;s++)e[s].style.display="none";for(let s=0;s<t;s++)e[s].style.display="block";this.dots.style.width=11*t+20*(t-1)+"px"}}n(document.querySelectorAll(".slider-main__page"),document.querySelector(".slider-main__controls"),"slider-dots controls-slider-main__dots","slider-dots__dot controls-slider-main__dot controls-slider-main__dot_","sliderMainDot");const r=new o({sliderWrap:document.querySelector(".slider-main__wrapper"),nextBtn:document.querySelector("#main-slider-arrow-right"),prevBtn:document.querySelector("#main-slider-arrow-left"),sliderPos:0,slidesPerSwipe:1,activeDot:document.querySelector(".controls-slider-main__dot_1"),sliderPages:Array.from(document.querySelectorAll(".slider-main__page")),dots:document.querySelector(".controls-slider-main__dots"),sliderName:"slider-main"});function n(e,t,s,i,o){const r=e.length,n=t;let c=document.createElement("div");c.className=`${s}`,c.style.width=27+20*(r-1)+11*(r-1)+"px";for(let e=0;e<r;e++){let t=document.createElement("div");t.className=`${i}${e+1}`,t.id=`${o}${e+1}`,c.append(t)}n.prepend(c)}r.activePage=r.sliderPages[0],r.activePage.classList.add("_active"),r.activeDot.classList.add("_active"),setTimeout((()=>{r.swipeRight()}),1e3),r.nextBtn.addEventListener("click",(()=>{r.swipeRight()})),r.prevBtn.addEventListener("click",(()=>{r.swipeLeft()})),r.dots.addEventListener("click",(e=>{r.swipeOnDot(e)})),r.sliderWrap.addEventListener("touchstart",(e=>{r.touchStart(e)})),r.sliderWrap.addEventListener("touchmove",(e=>{r.touchMove(e)})),r.sliderWrap.addEventListener("touchend",(()=>{r.touchEnd()})),r.sliderWrap.addEventListener("mousedown",(e=>{r.touchStart(e)})),r.sliderWrap.addEventListener("mouseup",(()=>{r.touchEnd()})),r.sliderWrap.addEventListener("mouseleave",(()=>{r.touchEnd()})),r.sliderWrap.addEventListener("mousemove",(e=>{r.touchMove(e)})),$(window).resize((function(){r.sliderWrap.style.transform=`translateX(${r.sliderPos*-r.calcSlideWidth()}px)`})),r.sliderPages.forEach((e=>{e.querySelector("img").addEventListener("dragstart",(e=>e.preventDefault()))})),n(document.querySelectorAll(".slider-rooms__page"),document.querySelector(".slider-rooms__controls"),"slider-dots controls-slider-rooms__dots","slider-dots__dot controls-slider-rooms__dot controls-slider-rooms__dot_","sliderRoomsDot");const c=new o({sliderWrap:document.querySelector(".slider-rooms__wrapper"),nextBtn:document.querySelector("#rooms-slider-arrow-right"),prevBtn:document.querySelector("#rooms-slider-arrow-left"),sliderPos:0,slidesPerSwipe:1,activeDot:document.querySelector(".controls-slider-rooms__dot_1"),sliderPages:Array.from(document.querySelectorAll(".slider-rooms__page")),dots:document.querySelector(".controls-slider-rooms__dots"),sliderName:"slider-rooms"});c.activePage=c.sliderPages[0],c.activeDot.classList.add("_active"),c.activePage.classList.add("_active"),c.dots.children[0].style.opacity="0",c.dots.children[c.dots.childElementCount-1].style.opacity="0",c.dots.children[c.dots.childElementCount-2].style.opacity="0",c.dots.children[c.dots.childElementCount-3].style.opacity="0",setTimeout((()=>{c.swipeRight()}),1e3),c.calcSlideWidth=()=>{let e;e=c.activePage.nextElementSibling?getComputedStyle(c.activePage.nextElementSibling).width:getComputedStyle(c.activePage.previousElementSibling).width,e=e.slice(0,3);let t=getComputedStyle(c.activePage).marginRight;return t=t.slice(0,2),e=+e+ +t,e},c.swipeRight=()=>{c.unlockAnimations(),c.sliderPos<c.sliderWrap.childElementCount-4?(c.sliderPos+=1,c.swipeSlider(),c.changeActiveSlide()):c.nextBtn.classList.contains("_blocked")||(c.sliderPos+=1,c.swipeSlider(),c.changeActiveSlide(),setTimeout((()=>{c.lockAnimations(),c.sliderPos=1,c.swipeSlider(),c.changeActiveSlide()}),600))},c.swipeLeft=()=>{c.unlockAnimations(),c.sliderPos>1?(c.sliderPos-=1,c.swipeSlider(),c.changeActiveSlide()):c.nextBtn.classList.contains("_blocked")||(c.sliderPos-=1,c.swipeSlider(),c.changeActiveSlide(),setTimeout((()=>{c.lockAnimations(),c.sliderPos=6,c.swipeSlider(),c.changeActiveSlide()}),600))},c.blockButtons=()=>{switch(c.sliderPos){case 0:c.prevBtn.classList.contains("_blocked")||c.prevBtn.classList.add("_blocked"),c.nextBtn.classList.contains("_blocked")||c.nextBtn.classList.add("_blocked");break;case c.sliderWrap.childElementCount-3:c.nextBtn.classList.contains("_blocked")||c.nextBtn.classList.add("_blocked"),c.prevBtn.classList.contains("_blocked")||c.prevBtn.classList.add("_blocked");break;default:c.nextBtn.classList.contains("_blocked")&&c.nextBtn.classList.remove("_blocked"),c.prevBtn.classList.contains("_blocked")&&c.prevBtn.classList.remove("_blocked")}},c.lockAnimations=()=>{c.sliderWrap.style.transition="none",$(".page-slider-rooms__image").css("transition","none"),$(".page-slider-rooms__content").css("transition","none")},c.unlockAnimations=()=>{c.sliderWrap.style.transition="",$(".page-slider-rooms__image").css("transition",""),$(".page-slider-rooms__content").css("transition","")},c.nextBtn.addEventListener("click",(()=>{c.swipeRight()})),c.prevBtn.addEventListener("click",(()=>{c.swipeLeft()})),c.dots.addEventListener("click",(e=>{c.unlockAnimations(),c.swipeOnDot(e)})),c.sliderWrap.addEventListener("touchstart",(e=>{c.touchStart(e)})),c.sliderWrap.addEventListener("touchmove",(e=>{c.touchMove(e)})),c.sliderWrap.addEventListener("touchend",(()=>{c.touchEnd()})),c.sliderWrap.addEventListener("mousedown",(e=>{c.touchStart(e)})),c.sliderWrap.addEventListener("mouseup",(()=>{c.touchEnd()})),c.sliderWrap.addEventListener("mouseleave",(()=>{c.touchEnd()})),c.sliderWrap.addEventListener("mousemove",(e=>{c.touchMove(e)})),$(window).resize((function(){setTimeout((()=>{c.sliderWrap.style.transform=`translateX(${c.sliderPos*-c.calcSlideWidth()}px)`}),1500)})),c.sliderPages.forEach((e=>{e.querySelector("img").addEventListener("dragstart",(e=>e.preventDefault()))})),n(document.querySelectorAll(".slider-tips__page"),document.querySelector(".slider-tips__controls"),"slider-dots controls-slider-tips__dots","slider-dots__dot controls-slider-tips__dot controls-slider-tips__dot_","sliderTipsDot");let l=3;document.documentElement.clientWidth<1350&&(l=2);const d=new o({sliderWrap:document.querySelector(".slider-tips__wrapper"),nextBtn:document.querySelector("#tips-slider-arrow-right"),prevBtn:document.querySelector("#tips-slider-arrow-left"),sliderPos:0,slidesPerSwipe:l,activeDot:document.querySelector(".controls-slider-tips__dot_1"),sliderPages:Array.from(document.querySelectorAll(".slider-tips__page")),dots:document.querySelector(".controls-slider-tips__dots"),sliderName:"slider-tips"});d.activePage=d.sliderPages[0],d.activeDot.classList.add("_active"),d.activePage.classList.add("_active"),d.blockButtons(),d.hideDots(),d.nextBtn.addEventListener("click",(()=>{d.swipeRight()})),d.prevBtn.addEventListener("click",(()=>{d.swipeLeft()})),d.dots.addEventListener("click",(e=>{d.swipeOnDot(e)})),d.sliderWrap.addEventListener("touchstart",(e=>{d.touchStart(e)})),d.sliderWrap.addEventListener("touchmove",(e=>{d.touchMove(e)})),d.sliderWrap.addEventListener("touchend",(()=>{d.touchEnd()})),d.sliderWrap.addEventListener("mousedown",(e=>{d.touchStart(e)})),d.sliderWrap.addEventListener("mouseup",(()=>{d.touchEnd()})),d.sliderWrap.addEventListener("mouseleave",(()=>{d.touchEnd()})),d.sliderWrap.addEventListener("mousemove",(e=>{d.touchMove(e)})),$(window).resize((function(){d.sliderWrap.style.transform=`translateX(${d.sliderPos*-d.calcSlideWidth()*d.slidesPerSwipe}px)`,document.documentElement.clientWidth>1350&&3!=d.slidesPerSwipe&&(d.slidesPerSwipe=3,d.hideDots(),d.sliderPos=0,d.swipeSlider()),document.documentElement.clientWidth>=700&&document.documentElement.clientWidth<=1350&&2!=d.slidesPerSwipe&&(d.slidesPerSwipe=2,d.hideDots(),d.sliderPos=0,d.swipeSlider()),document.documentElement.clientWidth<700&&1!=d.slidesPerSwipe&&(d.slidesPerSwipe=1,d.sliderPos=0,d.swipeSlider())})),d.sliderPages.forEach((e=>{e.querySelector("img").addEventListener("dragstart",(e=>e.preventDefault()))}));//!fix!!!!
const a=document.querySelector(".products");let u=0;function p(){_.classList.remove("_active"),_.classList.remove("_opened"),m.style.opacity="0",m.style.visibility="hidden"}a.addEventListener("click",(function(e){e.target.closest(".products__load-more-button")&&async function(e){if(!e.classList.contains("_hold")){e.classList.add("_hold");const t="https://datfeela.github.io/funiro/json/products.json";let s=await fetch(t,{method:"GET"});if(s.ok){!function(e,t){const s=document.querySelector(".products__items");if(u>=e.products.length)return void t.classList.add("_blocked");let i=0;for(let o=u;o<u+4;o++){let r=e.products[o];const n=r.id,c=r.image,l="https://datfeela.github.io/funiro/",d=r.title,a=r.text,p=r.price,_=r.priceOld,m=r.shareUrl,h=r.labels;let v=`<div data-prodid="${n}" class="products__product product">`,g="</div>",L="";if(h){let e='<div class="product__labels">',t="</div>",s="";h.forEach((e=>{s+=`<div class="product__label product__label_${e.type}">${e.value}</div>`})),L+=e,L+=s,L+=t}let y=`\n            <img class="product__image" src="${l}${c}" alt="${d}" />\n            `,S="",b=`\n            <h2 class="product__title">${d}</h2>\n            <span class="product__description">${a}</span>\n\t        `,w="",f=`<span class="product__price">Rp ${p}</span>`,E=`<span class="product__old-price">Rp ${_}</span>`;w='<div class="product__prices">',w+=f,_&&(w+=E),w+="</div>",S+='<div class="product__content">',S+=b,S+=w,S+="</div>";let k=`\n            <div class="product__popup popup-product">\n                <div class="popup-product__actions">\n                    <a href="" class="popup-product__button">Add to cart</a>\n                    <a href="${m}" class="popup-product__link">\n                        <svg class="popup-product__icon popup-product__icon_share">\n                            <use xlink:href="#share"></use>\n                        </svg>\n                        <span class="popup-product__text">Share</span>\n                    </a>\n                    <button class="popup-product__like-button">\n                        <svg class="popup-product__icon popup-product__icon_like">\n                            <use xlink:href="#favorite"></use>\n                        </svg>\n                        <span class="popup-product__text">Like</span>\n                    </button>\n                </div>\n            </div>\n\t    `,P="";P+=S,P+=k;let q="";if(q+=v,q+=L,q+=y,q+=P,q+=g,s.insertAdjacentHTML("beforeend",q),i++,u+i>=e.products.length)return u+=i,void t.classList.add("_blocked")}u+=i}(await s.json(),e),e.classList.remove("_hold")}else alert("something went wrong...")}}(e.target.closest(".products__load-more-button"))}));const _=document.querySelector(".actions__item.cart"),m=_.querySelector("span"),h=_.querySelector(".cart__list");let v=+m.innerHTML;a.addEventListener("click",(e=>{const t=e.target;if(t.closest(".popup-product__button")){let e=t.closest(".product");if(e.classList.contains("_added")){const t=e.dataset.prodid,s=document.querySelector(`.item-cart[data-prodid="${t}"]`);let i=s.querySelector(".quantity-cart__counter").innerHTML;s.querySelector(".quantity-cart__counter").innerHTML=++i,v++}else{e.classList.add("_added");let t=document.createElement("li");t.dataset.prodid=e.dataset.prodid,t.className="cart__item item-cart",t.insertAdjacentHTML("afterBegin",`\n                <img class="item-cart__image" src="${e.querySelector(".product__image").getAttribute("src")}" alt="">\n                <h2 class="item-cart__title">${e.querySelector(".product__title").innerHTML}</h2>\n                <span class="item-cart__price">${e.querySelector(".product__price").innerHTML}</span>\n                <div class="item-cart__quantity quantity-cart">\n                <button class="quantity-cart__button quantity-cart__button_minus">-</button>\n                <span class="quantity-cart__counter">1</span>\n                <button class="quantity-cart__button quantity-cart__button_plus">+</button>\n                </div>\n                <button class="item-cart__delete-button">\n                    <svg class="item-cart__icon">\n                        <use xlink:href="#delete"></use>\n                    </svg>\n                </button>\n                `),h.append(t),v++}_.classList.contains("_active")||(_.classList.add("_active"),m.style.opacity="1",m.style.visibility="visible"),v>99?(m.innerHTML="99+",m.style.height="20px",m.style.width="20px"):(m.innerHTML=`${v}`,m.style.height="16px",m.style.width="16px")}})),h.addEventListener("click",(e=>{const t=e.target;if(e.target.classList.contains("quantity-cart__button_minus")){let s=t.nextElementSibling.innerHTML;if(s>1)t.nextElementSibling.innerHTML=--s,v--;else{e.preventDefault();const s=t.closest(".item-cart").dataset.prodid;document.querySelector(`.product[data-prodid="${s}"]`).classList.remove("_added"),t.closest(".item-cart").remove(),v--}}if(e.target.classList.contains("quantity-cart__button_plus")){let e=t.previousElementSibling.innerHTML;t.previousElementSibling.innerHTML=++e,v++}v>99?(m.innerHTML="99+",m.style.height="20px",m.style.width="20px"):(m.innerHTML=`${v}`,m.style.height="16px",m.style.width="16px"),v<1&&p()})),i.addEventListener("click",(e=>{const t=e.target;if(t.closest(".item-cart__delete-button")){e.preventDefault();let s=t.closest(".item-cart").querySelector(".quantity-cart__counter").innerHTML;const i=t.closest(".item-cart").dataset.prodid;document.querySelector(`.product[data-prodid="${i}"]`).classList.remove("_added"),v-=s,t.closest(".item-cart").remove(),m.innerHTML=`${v}`,v<1&&p()}})),i.addEventListener("click",(e=>{const t=e.target,s=document.querySelector(".cart__delete-popup"),i=document.querySelector(".cart__delete-popup-button_yes"),o=document.querySelector(".cart__delete-popup-button_no");t.classList.contains("cart__delete-button")&&(s.classList.add("_active"),i.onclick=()=>{document.querySelectorAll(".product._added").forEach((e=>{e.classList.remove("_added")})),t.previousElementSibling.innerHTML="",v=0,p(),s.classList.remove("_active")},o.onclick=()=>{s.classList.remove("_active")})})),i.addEventListener("click",(e=>{const t=e.target;(t.closest(".cart__icon")||t.closest(".search-form"))&&_.classList.contains("_opened")?_.classList.remove("_opened"):t.closest(".cart__icon")&&!_.classList.contains("_opened")&&_.classList.contains("_active")&&_.classList.add("_opened")})),$(".footer__title").click((function(){document.documentElement.clientWidth<=576&&($(this).next(".footer__list").slideToggle(),$(this).parent().toggleClass("_active"))})),$(window).resize((function(){document.documentElement.clientWidth>576&&($(".footer__list").css("display","block"),$(".footer__block").hasClass("_active")&&$(".footer__block").removeClass("_active")),document.documentElement.clientWidth<576&&($(".footer__block").hasClass("_active")||$(".footer__list").css("display","none"))}))}));